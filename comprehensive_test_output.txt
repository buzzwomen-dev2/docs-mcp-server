======================================================================
COMPREHENSIVE MCP SERVER TEST SUITE
======================================================================
Started at: 2025-12-10T15:35:27.469108
======================================================================

======================================================================
RUNNING: Core Functionality Tests
======================================================================

======================================================================
COMPREHENSIVE SEARCH ENGINE TESTS
======================================================================


Running test_basic_search...
‚úì Basic search returned 5 results
  Top result: Using the Django authentication system (score: 1.484)

Running test_bm25_search_not_zero...
‚úì BM25 search working - top BM25 score: 0.973

Running test_component_filter...
‚úì Component filter returned 5 results

Running test_cross_tech_search...
‚úì Cross-tech search found results from: django, psycopg

Running test_empty_query...
‚úì Empty query handled gracefully

Running test_exact_method_name_search...
‚úì Exact method name searches working

Running test_get_stats...
‚úì Index stats retrieved: 29026 total chunks
  Technologies: psycopg, django, drf

Running test_hybrid_scoring...
‚úì Hybrid scoring working correctly
  BM25: 0.893, Semantic: 0.976
  Hybrid: 1.131

Running test_initialization...
‚úì IndexManager initialized successfully

Running test_list_sources...
‚úì Listed 737 source files

Running test_long_query...
‚úì Long query handled

Running test_natural_language_query...
‚úì Natural language queries working

Running test_results_sorted_by_score...
‚úì Results properly sorted by score

Running test_retrieve_chunk...
‚úì Successfully retrieved chunk: docs_django-6_0_releases_0_96_md_2_69b7c04ae10d

Running test_score_ranges...
‚úì All scores in valid range [0, 1]

Running test_semantic_search_not_zero...
‚úì Semantic search working - top semantic score: 0.966

Running test_special_characters_query...
‚úì Special character queries handled

Running test_tech_filter...
‚úì Tech filter working - 5 Django results

Running test_top_k_limit...
‚úì top_k parameter working correctly

======================================================================
TEST SUMMARY
======================================================================
Total tests:  19
Passed:       19 (100.0%)
Failed:       0


======================================================================
RUNNING: Score Accuracy Tests
======================================================================

======================================================================
SCORE ACCURACY TESTS
======================================================================

Validating search score accuracy and thresholds...


======================================================================
EXACT MATCH SCORE TESTS
======================================================================

‚úÖ Exact class name match
   Query: 'ForeignKey'
   BM25: 0.973 (min: 0.6)
   Hybrid: 1.133 (min: 0.5)

‚úÖ Exact DRF class name
   Query: 'ModelSerializer'
   BM25: 0.743 (min: 0.6)
   Hybrid: 0.921 (min: 0.5)

‚úÖ Exact psycopg class name
   Query: 'AsyncConnection'
   BM25: 1.000 (min: 0.5)
   Hybrid: 1.050 (min: 0.5)

======================================================================
SEMANTIC SIMILARITY SCORE TESTS
======================================================================

‚úÖ Natural language auth query
   Query: 'How to authenticate users in Django...'
   Semantic: 0.968 (min: 0.7)
   Hybrid: 1.348 (min: 0.6)

‚úÖ Natural language serialization query
   Query: 'What is the best way to serialize data in REST API...'
   Semantic: 0.935 (min: 0.6)
   Hybrid: 0.907 (min: 0.5)

‚úÖ Natural language connection query
   Query: 'How to manage database connections efficiently...'
   Semantic: 0.980 (min: 0.6)
   Hybrid: 0.917 (min: 0.5)

======================================================================
HYBRID BALANCE TESTS
======================================================================

‚úÖ Mixed keyword and semantic query
   BM25: 1.000
   Semantic: 1.000
   Hybrid: 1.050 (base: 1.000)

‚úÖ DRF mixed query
   BM25: 0.827
   Semantic: 1.000
   Hybrid: 0.977 (base: 0.931)

‚úÖ Psycopg mixed query
   BM25: 0.623
   Semantic: 0.952
   Hybrid: 0.861 (base: 0.820)

======================================================================
SCORE CONSISTENCY TESTS
======================================================================

‚úÖ Django models
   Scores: 0.7200 vs 0.7200
   Difference: 0.000000

‚úÖ DRF serializers
   Scores: 1.0007 vs 1.0007
   Difference: 0.000000

‚úÖ psycopg connection
   Scores: 1.0443 vs 1.0443
   Difference: 0.000000

======================================================================
SCORE ORDERING TESTS
======================================================================

‚úÖ Relevant vs irrelevant query scores
   Relevant: 1.274
   Irrelevant: 0.860
   Difference: +0.414

======================================================================
SCORE ACCURACY TEST SUMMARY
======================================================================

Total tests:  13
Passed:       13 (100.0%)
Failed:       0

üìä Detailed results saved to: /home/mathur/projects/docs-mcp-server/tests/score_accuracy_results.json


======================================================================
RUNNING: Integration Tests
======================================================================

======================================================================
INTEGRATION TESTS
======================================================================

Testing complete workflows and integrations...


======================================================================
FULL INDEXING FLOW TEST
======================================================================

üìä Index stats before: 29026 chunks

üìö Re-indexing: docs/django-6.0/faq
   Files processed: 0
   Chunks created: 0

üìä Index stats after: 29026 chunks

======================================================================
CROSS-TECH WORKFLOW TEST
======================================================================

üîç Query: 'authentication'
   Found techs: drf, django
   Expected techs: django, drf
   ‚úÖ Found expected technologies

üîç Query: 'connection'
   Found techs: psycopg, django
   Expected techs: django, psycopg
   ‚úÖ Found expected technologies

üîç Query: 'serializer'
   Found techs: drf, django
   Expected techs: drf
   ‚úÖ Found expected technologies

======================================================================
FILTER COMBINATION TEST
======================================================================

üîç Tech filter only
   Query: 'models'
   Results: 5
   ‚úÖ Filters working correctly

üîç Tech + component filter
   Query: 'authentication'
   Results: 5
   ‚ö†Ô∏è  2 results don't match component filter
   ‚úÖ Filters working correctly

üîç No filters
   Query: 'serializer'
   Results: 5
   ‚úÖ Filters working correctly

======================================================================
SEARCH -> RETRIEVE WORKFLOW TEST
======================================================================

üîç Searching for 'Django models'...
   Found 3 results

   Retrieving chunk 1: docs_django-6_0_topics_db_models_md_114_433f047ff7c8
      ‚úÖ Retrieved: Models

   Retrieving chunk 2: docs_django-6_0_topics_db_queries_md_6_c406774da0a8
      ‚úÖ Retrieved: Making queries

   Retrieving chunk 3: docs_django-6_0_topics_db_queries_md_23_12fe911b4cca
      ‚úÖ Retrieved: Making queries

======================================================================
TECH-SPECIFIC CLEAR TEST
======================================================================

üìä Technologies before: drf, psycopg, django

‚ö†Ô∏è  Skipping actual clear to preserve test data
   (clear_tech method tested in unit tests)

======================================================================
CONCURRENT SEARCH TEST
======================================================================

üîç Running 5 concurrent searches...

   Results: [5, 5, 5, 5, 5]
   ‚úÖ All concurrent searches succeeded

======================================================================
EDGE CASE QUERIES TEST
======================================================================

   Testing: Empty query
      ‚úÖ Handled gracefully (5 results)

   Testing: Whitespace only
      ‚úÖ Handled gracefully (5 results)

   Testing: Single character
      ‚úÖ Handled gracefully (5 results)

   Testing: Very long query
      ‚úÖ Handled gracefully (5 results)

   Testing: Apostrophe
      ‚úÖ Handled gracefully (5 results)

   Testing: Special character
      ‚úÖ Handled gracefully (5 results)

   Testing: Comparison
      ‚úÖ Handled gracefully (5 results)

======================================================================
INTEGRATION TEST SUMMARY
======================================================================

Total tests:  11
Passed:       10 (90.9%)
Failed:       1

FAILED TESTS:
  ‚ùå full_indexing_flow
     {'files_processed': 0, 'files_skipped': 9, 'files_updated': 0, 'chunks_created': 0, 'chunks_removed': 0, 'errors': 0}


======================================================================
RUNNING: Query Accuracy Tests (40+ queries)
======================================================================

======================================================================
MCP SERVER ACCURACY TESTS
======================================================================

Loaded 48 test cases

[1/48] Testing: Django ORM transactions and atomic operations...
  ‚úÖ PASS - Top result: Database transactions
           Score: 1.237

[2/48] Testing: How to define Django model relationships and foreign keys...
  ‚úÖ PASS - Top result: Models
           Score: 1.088

[3/48] Testing: Django queryset filter and exclude methods...
  ‚úÖ PASS - Top result: Managers
           Score: 1.151

[4/48] Testing: Django model field types and options...
  ‚ùå FAIL
           - Missing expected keywords in top 5: IntegerField

[5/48] Testing: Django migrations create and apply...
  ‚úÖ PASS - Top result: Writing your first Django app, part 2
           Score: 1.276

[6/48] Testing: Django authentication middleware and login...
  ‚úÖ PASS - Top result: Using the Django authentication system
           Score: 1.152

[7/48] Testing: Django user permissions and authorization...
  ‚úÖ PASS - Top result: Customizing authentication in Django
           Score: 1.247

[8/48] Testing: Django password hashing and validation...
  ‚úÖ PASS - Top result: Writing and running tests
           Score: 1.157

[9/48] Testing: Django session management and cookies...
  ‚úÖ PASS - Top result: How to use sessions
           Score: 1.462

[10/48] Testing: Django custom user model creation...
  ‚úÖ PASS - Top result: Customizing authentication in Django
           Score: 1.201

[11/48] Testing: DRF serializer validation and custom validators...
  ‚úÖ PASS - Top result: Validators
           Score: 1.155

[12/48] Testing: DRF ModelSerializer fields and relations...
  ‚úÖ PASS - Top result: Serializers
           Score: 1.043

[13/48] Testing: DRF nested serializers and writable nested representations...
  ‚úÖ PASS - Top result: Writable nested serializers
           Score: 1.088

[14/48] Testing: DRF serializer read_only and write_only fields...
  ‚ùå FAIL
           - Missing expected keywords in top 5: write_only

[15/48] Testing: DRF serializer context and instance...
  ‚úÖ PASS - Top result: HTML & Forms
           Score: 1.091

[16/48] Testing: DRF ViewSet and Router configuration...
  ‚úÖ PASS - Top result: Routers
           Score: 1.019

[17/48] Testing: DRF permission classes and authentication...
  ‚úÖ PASS - Top result: Authentication
           Score: 0.977

[18/48] Testing: DRF pagination classes and settings...
  ‚ùå FAIL
           - Missing expected keywords in top 5: limit

[19/48] Testing: DRF filtering and search backends...
  ‚ùå FAIL
           - Missing expected keywords in top 5: backend

[20/48] Testing: DRF action decorator and custom endpoints...
  ‚úÖ PASS - Top result: Tutorial 6: ViewSets & Routers
           Score: 1.049

[21/48] Testing: psycopg connection parameters and DSN...
  ‚úÖ PASS - Top result: `_dns` ‚Äì DNS resolution utilities
           Score: 1.026

[22/48] Testing: psycopg connection pool configuration...
  ‚úÖ PASS - Top result: `psycopg_pool` ‚Äì Connection pool implementations
           Score: 1.118

[23/48] Testing: psycopg transaction management and commit...
  ‚úÖ PASS - Top result: Transactions management
           Score: 0.883

[24/48] Testing: psycopg cursor types and usage...
  ‚úÖ PASS - Top result: `types` ‚Äì Types information and adapters
           Score: 1.080

[25/48] Testing: psycopg connection context manager...
  ‚úÖ PASS - Top result: Basic module usage
           Score: 1.050

[26/48] Testing: psycopg async connection and await...
  ‚úÖ PASS - Top result: `psycopg` release notes
           Score: 0.931

[27/48] Testing: psycopg AsyncConnection and AsyncCursor...
  ‚úÖ PASS - Top result: Concurrent operations
           Score: 1.040

[28/48] Testing: psycopg async pool usage...
  ‚úÖ PASS - Top result: `psycopg_pool` release notes
           Score: 1.023

[29/48] Testing: psycopg server-side cursors...
  ‚úÖ PASS - Top result: `psycopg` release notes
           Score: 1.132

[30/48] Testing: psycopg copy operations and bulk insert...
  ‚úÖ PASS - Top result: Using COPY TO and COPY FROM
           Score: 1.188

[31/48] Testing: database connection pooling best practices...
  ‚úÖ PASS - Top result: Databases
           Score: 0.958

[32/48] Testing: REST API authentication methods...
  ‚úÖ PASS - Top result: Authentication
           Score: 1.083

[33/48] Testing: ORM query optimization techniques...
  ‚úÖ PASS - Top result: Database access optimization
           Score: 1.179

[34/48] Testing: middleware execution order...
  ‚úÖ PASS - Top result: Middleware
           Score: 1.133

[35/48] Testing: serialization and data validation...
  ‚úÖ PASS - Top result: Tutorial 1: Serialization
           Score: 1.121

[36/48] Testing: get_or_create...
  ‚úÖ PASS - Top result: `QuerySet` API reference
           Score: 0.959

[37/48] Testing: CharField max_length...
  ‚úÖ PASS - Top result: Creating forms from models
           Score: 1.185

[38/48] Testing: APIView vs ViewSet...
  ‚úÖ PASS - Top result: Parsers
           Score: 1.039

[39/48] Testing: execute vs executemany...
  ‚úÖ PASS - Top result: Basic module usage
           Score: 1.020

[40/48] Testing: what is select_related...
  ‚úÖ PASS - Top result: Django 1.7 release notes
           Score: 0.995

[41/48] Testing: middleware...
  ‚úÖ PASS - Top result: Translation
           Score: 1.049

[42/48] Testing: How to optimize database queries for performance...
  ‚úÖ PASS - Top result: Database access optimization
           Score: 1.045

[43/48] Testing: async await...
  ‚úÖ PASS - Top result: Signals
           Score: 1.007

[44/48] Testing: permission_classes...
  ‚úÖ PASS - Top result: Quickstart
           Score: 1.008

[45/48] Testing: How do I handle errors and exceptions...
  ‚úÖ PASS - Top result: `errors` ‚Äì Package exceptions
           Score: 1.099

[46/48] Testing: transaction commit rollback database...
  ‚úÖ PASS - Top result: Database transactions
           Score: 1.024

[47/48] Testing: best practices for securing API endpoints...
  ‚úÖ PASS - Top result: Authentication
           Score: 0.913

[48/48] Testing: performance optimization tips...
  ‚úÖ PASS - Top result: Using Django
           Score: 1.189

======================================================================
TEST SUMMARY
======================================================================
Total tests:  48
Passed:       44 (91.7%)
Failed:       4

FAILED TESTS:

‚ùå Django model field types and options
   - Missing expected keywords in top 5: IntegerField

‚ùå DRF serializer read_only and write_only fields
   - Missing expected keywords in top 5: write_only

‚ùå DRF pagination classes and settings
   - Missing expected keywords in top 5: limit

‚ùå DRF filtering and search backends
   - Missing expected keywords in top 5: backend


======================================================================
COMPREHENSIVE TEST SUMMARY
======================================================================

Test Suites Run: 4
Passed: 2
Failed: 2

Detailed Results:
  ‚úÖ PASS - Core Functionality Tests
  ‚úÖ PASS - Score Accuracy Tests
  ‚ùå FAIL - Integration Tests
  ‚ùå FAIL - Query Accuracy Tests (40+ queries)

‚ö†Ô∏è  2 TEST SUITE(S) FAILED

üìä Results saved to: /home/mathur/projects/docs-mcp-server/tests/comprehensive_test_results.json
