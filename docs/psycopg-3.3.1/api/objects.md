# Other top-level objects

## Connection information

### *class* psycopg.ConnectionInfo

Allow access to information about the connection.

The object is usually returned by [`Connection.info`](connections.md#psycopg.Connection.info).

#### dsn

Return the connection string to connect to the database.

The string contains all the parameters set to a non-default value,
which might come either from the connection string and parameters
passed to [`connect()`](connections.md#psycopg.Connection.connect) or from environment variables. The
password is never returned (you can read it using the [`password`](#psycopg.ConnectionInfo.password)
attribute).

#### NOTE
The [`get_parameters()`](#psycopg.ConnectionInfo.get_parameters) method returns the same information
as a dict.

#### status

The status of the connection. See `[PQstatus()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQSTATUS)`.

The status can be one of a number of values. However, only two of
these are seen outside of an asynchronous connection procedure:
[`OK`](pq.md#psycopg.pq.ConnStatus.OK) and [`BAD`](pq.md#psycopg.pq.ConnStatus.BAD). A good connection to the
database has the status `OK`. Ordinarily, an `OK` status will remain
so until [`Connection.close()`](connections.md#psycopg.Connection.close), but a communications failure might
result in the status changing to `BAD` prematurely.

#### transaction_status

The current in-transaction status of the session.
See `[PQtransactionStatus()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQTRANSACTIONSTATUS)`.

The status can be [`IDLE`](pq.md#psycopg.pq.TransactionStatus.IDLE) (currently idle),
[`ACTIVE`](pq.md#psycopg.pq.TransactionStatus.ACTIVE) (a command is in progress),
[`INTRANS`](pq.md#psycopg.pq.TransactionStatus.INTRANS) (idle, in a valid transaction block),
or [`INERROR`](pq.md#psycopg.pq.TransactionStatus.INERROR) (idle, in a failed transaction
block). [`UNKNOWN`](pq.md#psycopg.pq.TransactionStatus.UNKNOWN) is reported if the connection
is bad. `ACTIVE` is reported only when a query has been sent to the
server and not yet completed.

#### pipeline_status

The current pipeline status of the client.
See `[PQpipelineStatus()](https://www.postgresql.org/docs/18/libpq-pipeline-mode.html#LIBPQ-PQPIPELINESTATUS)`.

#### backend_pid

The process ID (PID) of the backend process handling this connection.
See `[PQbackendPID()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQBACKENDPID)`.

#### vendor

A string representing the database vendor connected to.

Normally it is `PostgreSQL`; it may be different if connected to
a different database.

#### Versionadded
Added in version 3.1.

#### server_version

An integer representing the server version. See `[PQserverVersion()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQSERVERVERSION)`.

The number is formed by converting the major, minor, and revision
numbers into two-decimal-digit numbers and appending them together.
Starting from PostgreSQL 10 the minor version was dropped, so the
second group of digits is always 00. For example, version 9.3.5 is
returned as 90305, version 10.2 as 100002.

#### full_protocol_version

An integer representing the server full protocol version.

Return a value in the format described in `[PQfullProtocolVersion()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQFULLPROTOCOLVERSION)`.

Only meaningful if the libpq used is version 18 or greater. If the
version is lesser than that, return the value reported by
`[PQprotocolVersion()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQPROTOCOLVERSION)` (but in the same format as above, e.g. 30000
for version 3). You can use [`Capabilities.has_full_protocol_version()`](#psycopg.Capabilities.has_full_protocol_version)
to verify if the value can be considered reliable.

#### Versionadded
Added in version 3.3.

#### error_message

The error message most recently generated by an operation on the connection.
See `[PQerrorMessage()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQERRORMESSAGE)`.

#### get_parameters() → [dict](https://docs.python.org/3/library/stdtypes.html#dict)[[str](https://docs.python.org/3/library/stdtypes.html#str), [str](https://docs.python.org/3/library/stdtypes.html#str)]

Return the connection parameters values.

Return all the parameters set to a non-default value, which might come
either from the connection string and parameters passed to
[`connect()`](connections.md#psycopg.Connection.connect) or from environment variables. The password
is never returned (you can read it using the [`password`](#psycopg.ConnectionInfo.password) attribute).

#### NOTE
The [`dsn`](#psycopg.ConnectionInfo.dsn) attribute returns the same information in the form
as a string.

#### timezone

The Python timezone info of the connection’s timezone.

```pycon
>>> conn.info.timezone
zoneinfo.ZoneInfo(key='Europe/Rome')
```

#### host

The server host name of the active connection. See `[PQhost()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQHOST)`.

This can be a host name, an IP address, or a directory path if the
connection is via Unix socket. (The path case can be distinguished
because it will always be an absolute path, beginning with `/`.)

#### hostaddr

The server IP address of the connection. See `[PQhostaddr()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQHOSTADDR)`.

Only available if the libpq used is from PostgreSQL 12 or newer.
Raise [`NotSupportedError`](errors.md#psycopg.NotSupportedError) otherwise. You can use the
[`has_hostaddr`](#psycopg.Capabilities.has_hostaddr) capability to check for its support.

#### port

The port of the active connection. See `[PQport()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQPORT)`.

#### dbname

The database name of the connection. See `[PQdb()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQDB)`.

#### user

The user name of the connection. See `[PQuser()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQUSER)`.

#### password

The password of the connection. See `[PQpass()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQPASS)`.

#### options

The command-line options passed in the connection request.
See `[PQoptions](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQOPTIONS)`.

#### parameter_status(param_name: [str](https://docs.python.org/3/library/stdtypes.html#str)) → [str](https://docs.python.org/3/library/stdtypes.html#str) | [None](https://docs.python.org/3/library/constants.html#None)

Return a parameter setting of the connection.

Return [`None`](https://docs.python.org/3/library/constants.html#None) is the parameter is unknown.

Example of parameters are `server_version`,
`standard_conforming_strings`… See `[PQparameterStatus()](https://www.postgresql.org/docs/18/libpq-status.html#LIBPQ-PQPARAMETERSTATUS)` for
all the available parameters.

#### encoding

The Python codec name of the connection’s client encoding.

The value returned is always normalized to the Python codec
[`name`](https://docs.python.org/3/library/codecs.html#codecs.CodecInfo.name):

```default
conn.execute("SET client_encoding TO LATIN9")
conn.info.encoding
'iso8859-15'
```

A few PostgreSQL encodings are not available in Python and cannot be
selected (currently `EUC_TW`, `MULE_INTERNAL`). The PostgreSQL
`SQL_ASCII` encoding has the special meaning of “no encoding”: see
[Strings adaptation](../basic/adapt.md#adapt-string) for details.

#### SEE ALSO
The [PostgreSQL supported encodings](https://www.postgresql.org/docs/current/multibyte.html).

<a id="capabilities"></a>

## Libpq capabilities information

### *class* psycopg.Capabilities

An object to check if a feature is supported by the libpq available on the client.

An instance of this object is normally exposed by the module as the object
[`psycopg.capabilities`](module.md#psycopg.capabilities).

Every feature check is implemented by an `has_SOMETHING()` method. All
the methods return a boolean value stating if the capability is supported,
which can be used by a program to degrade gracefully:

```default
if psycopg.capabilities.has_pipeline()
    with conn.pipeline():
        operations(conn)
else:
    logger.warning("slower")
    operations(conn)
```

If `check` is `True`, and the capability is not supported, raise a
[`NotSupportedError`](errors.md#psycopg.NotSupportedError) instead of returning `False`, explaining why the
feature is not supported. This allows to make a check at import time,
crashing early and with a clear description of the problem.

```pycon
>>> import psycopg
>>> psycopg.capabilities.has_pipeline(check=True)
Traceback (most recent call last):
  ...
psycopg.NotSupportedError: the feature 'Connection.pipeline()' is not available:
    the client libpq version (imported from system libraries) is 13.4; the
    feature requires libpq version 14.0 or newer
```

#### Versionadded
Added in version 3.2.

#### has_full_protocol_version(check: [bool](https://docs.python.org/3/library/functions.html#bool) = False) → [bool](https://docs.python.org/3/library/functions.html#bool)

Check if the `PGconn.full_protocol_version()` method is implemented.

If the method is implemented, then [`ConnectionInfo.full_protocol_version`](#psycopg.ConnectionInfo.full_protocol_version)
will return a meaningful value.

The feature requires libpq 18.0 and greater.

#### Versionadded
Added in version 3.3.

#### has_encrypt_password(check: [bool](https://docs.python.org/3/library/functions.html#bool) = False) → [bool](https://docs.python.org/3/library/functions.html#bool)

Check if the `PGconn.encrypt_password()` method is implemented.

The feature requires libpq 10.0 or greater.

#### has_hostaddr(check: [bool](https://docs.python.org/3/library/functions.html#bool) = False) → [bool](https://docs.python.org/3/library/functions.html#bool)

Check if the [`ConnectionInfo.hostaddr`](#psycopg.ConnectionInfo.hostaddr) attribute is implemented.

The feature requires libpq 12.0 or greater.

#### has_pipeline(check: [bool](https://docs.python.org/3/library/functions.html#bool) = False) → [bool](https://docs.python.org/3/library/functions.html#bool)

Check if the [pipeline mode](../advanced/pipeline.md#pipeline-mode) is supported.

The feature requires libpq 14.0 or greater.

#### has_set_trace_flags(check: [bool](https://docs.python.org/3/library/functions.html#bool) = False) → [bool](https://docs.python.org/3/library/functions.html#bool)

Check if the [`pq.PGconn.set_trace_flags()`](pq.md#psycopg.pq.PGconn.set_trace_flags) method is implemented.

The feature requires libpq 14.0 or greater.

#### has_used_gssapi(check: [bool](https://docs.python.org/3/library/functions.html#bool) = False) → [bool](https://docs.python.org/3/library/functions.html#bool)

Check if the [`pq.PGconn.used_gssapi`](pq.md#psycopg.pq.PGconn.used_gssapi) attribute is implemented.

The feature requires libpq 16.0 or greater.

#### Versionadded
Added in version 3.3.

#### has_cancel_safe(check: [bool](https://docs.python.org/3/library/functions.html#bool) = False) → [bool](https://docs.python.org/3/library/functions.html#bool)

Check if the [`Connection.cancel_safe()`](connections.md#psycopg.Connection.cancel_safe) method is implemented.

The feature requires libpq 17.0 or greater.

#### NOTE
The `cancel_safe()` method is implemented anyway, but it will use
the legacy `[PQcancel](https://www.postgresql.org/docs/18/libpq-cancel.html#LIBPQ-PQCANCEL)` implementation.

#### has_stream_chunked(check: [bool](https://docs.python.org/3/library/functions.html#bool) = False) → [bool](https://docs.python.org/3/library/functions.html#bool)

Check if [`Cursor.stream()`](cursors.md#psycopg.Cursor.stream) can handle a `size` parameter value
greater than 1 to retrieve results by chunks.

The feature requires libpq 17.0 or greater.

#### has_send_close_prepared(check: [bool](https://docs.python.org/3/library/functions.html#bool) = False) → [bool](https://docs.python.org/3/library/functions.html#bool)

Check if the `pq.PGconn.send_closed_prepared()` method is implemented.

The feature requires libpq 17.0 or greater.

#### SEE ALSO
[Using prepared statements with PgBouncer](../advanced/prepare.md#pgbouncer)

## The description [`Column`](#psycopg.Column) object

### *class* psycopg.Column

An object describing a column of data from a database result, [as described
by the DBAPI](https://www.python.org/dev/peps/pep-0249/#description), so it can also be unpacked as a 7-items tuple.

The object is returned by [`Cursor.description`](cursors.md#psycopg.Cursor.description).

#### name

The name of the column.

#### type_code

The numeric OID of the column.

#### type_display

A pretty representation of the column type.

It is composed by the type name, followed by eventual modifiers and
brackets to signify arrays, e.g. `text`, `varchar(42)`,
`date[]`.

#### Versionadded
Added in version 3.2.

#### display_size

The field size, for string types such as `varchar(n)`.

#### internal_size

The internal field size for fixed-size types, None otherwise.

#### precision

The number of digits for fixed precision types.

#### scale

The number of digits after the decimal point if available.

## Notifications

### *class* psycopg.Notify

An asynchronous notification received from the database.

The object is usually returned by [`Connection.notifies()`](connections.md#psycopg.Connection.notifies).

#### channel *: [str](https://docs.python.org/3/library/stdtypes.html#str)*

The name of the channel on which the notification was received.

#### payload *: [str](https://docs.python.org/3/library/stdtypes.html#str)*

The message attached to the notification.

#### pid *: [int](https://docs.python.org/3/library/functions.html#int)*

The PID of the backend process which sent the notification.

## Pipeline-related objects

See [Pipeline mode support](../advanced/pipeline.md#pipeline-mode) for details.

### *class* psycopg.Pipeline(conn: [Connection](connections.md#psycopg.Connection)[Any], \_no_lock: [bool](https://docs.python.org/3/library/functions.html#bool) = False)

Handler for (sync) connection in pipeline mode.

This objects is returned by [`Connection.pipeline()`](connections.md#psycopg.Connection.pipeline).

#### sync() → [None](https://docs.python.org/3/library/constants.html#None)

Sync the pipeline, send any pending command and receive and process
all available results.

#### *classmethod* is_supported() → [bool](https://docs.python.org/3/library/functions.html#bool)

Return `True` if the psycopg libpq wrapper supports pipeline mode.

### *class* psycopg.AsyncPipeline(conn: [AsyncConnection](connections.md#psycopg.AsyncConnection)[Any], \_no_lock: [bool](https://docs.python.org/3/library/functions.html#bool) = False)

Handler for (async) connection in pipeline mode.

This objects is returned by [`AsyncConnection.pipeline()`](connections.md#psycopg.AsyncConnection.pipeline).

#### *async* sync() → [None](https://docs.python.org/3/library/constants.html#None)

Sync the pipeline, send any pending command and receive and process
all available results.

## Transaction-related objects

See [Transactions management](../basic/transactions.md#transactions) for details about these objects.

### *class* psycopg.IsolationLevel

Enum representing the isolation level for a transaction.

The value is usually used with the [`Connection.isolation_level`](connections.md#psycopg.Connection.isolation_level) property.

Check the PostgreSQL documentation for a description of the effects of the
different [levels of transaction isolation](https://www.postgresql.org/docs/current/transaction-iso.html).

#### READ_UNCOMMITTED *= 1*

#### READ_COMMITTED *= 2*

#### REPEATABLE_READ *= 3*

#### SERIALIZABLE *= 4*

### *class* psycopg.Transaction

Returned by [`Connection.transaction()`](connections.md#psycopg.Connection.transaction) to handle a transaction block.

#### savepoint_name

The name of the savepoint; `None` if handling the main transaction.

#### connection

The connection the object is managing.

* **Type:**
  [`Connection`](connections.md#psycopg.Connection)

#### status

The current status of the transaction.

* **Type:**
  [`Status`](#psycopg.psycopg.Transaction.Status)

See [Transaction status](../basic/transactions.md#transaction-status) for more details and examples.

### *class* psycopg.AsyncTransaction

Returned by [`AsyncConnection.transaction()`](connections.md#psycopg.AsyncConnection.transaction) to handle a transaction block.

The class differs from [`Transaction`](#psycopg.Transaction) for the following details:

#### connection

The connection the object is managing.

* **Type:**
  [`AsyncConnection`](connections.md#psycopg.AsyncConnection)

#### *class* psycopg.Transaction.Status

### *class* psycopg.AsyncTransaction.Status

The current status of a transaction.

Exposed as the [`status`](#psycopg.Transaction.status) attribute of
[`Transaction`](#psycopg.Transaction) and [`AsyncTransaction`](#psycopg.AsyncTransaction) objects.

<!-- note: `:members:` doeesn't seem to work currently. Nested class problem? -->

#### NON_STARTED

Transaction created but not yet entered.

#### ACTIVE

Transaction currently active (inside the `with` block).

#### COMMITTED

Transaction successfully committed.

#### ROLLED_BACK_EXPLICITLY

The transaction was explicitly rolled back (by raising
[`Rollback`](#psycopg.Rollback) or calling `transaction(force_rollback=True)`).

#### ROLLED_BACK_WITH_ERROR

The transaction was rolled back due to an exception raised within the
transaction block.

#### FAILED

The transaction failed due to a connection failure (e.g., the
connection was closed or became unavailable during the transaction).

### *exception* psycopg.Rollback(transaction: [Transaction](#psycopg.Transaction) | [AsyncTransaction](#psycopg.AsyncTransaction) | [None](https://docs.python.org/3/library/constants.html#None) = None)

Exit the current [`Transaction`](#psycopg.Transaction) context immediately and rollback any changes
made within this context.

If a transaction context is specified in the constructor, rollback
enclosing transactions contexts up to and including the one specified.

It can be used as:

- `raise Rollback`: roll back the operation that happened in the current
  transaction block and continue the program after the block.
- `raise Rollback()`: same effect as above
- `raise Rollback(*tx*)`: roll back any operation that happened in
  the [`Transaction`](#psycopg.Transaction) `tx` (returned by a statement such as `with
  conn.transaction() as *tx*:` and all the blocks nested within. The
  program will continue after the `tx` block.

## Two-Phase Commit related objects

### *class* psycopg.Xid

A two-phase commit transaction identifier.

The object can also be unpacked as a 3-item tuple ([`format_id`](#psycopg.Xid.format_id), [`gtrid`](#psycopg.Xid.gtrid),
[`bqual`](#psycopg.Xid.bqual)).

See [Two-Phase Commit protocol support](../basic/transactions.md#two-phase-commit) for details.

#### format_id *: [int](https://docs.python.org/3/library/functions.html#int) | [None](https://docs.python.org/3/library/constants.html#None)*

Format Identifier of the two-phase transaction.

#### gtrid *: [str](https://docs.python.org/3/library/stdtypes.html#str)*

Global Transaction Identifier of the two-phase transaction.

If the Xid doesn’t follow the XA standard, it will be the PostgreSQL
ID of the transaction (in which case [`format_id`](#psycopg.Xid.format_id) and [`bqual`](#psycopg.Xid.bqual) will be
`None`).

#### bqual *: [str](https://docs.python.org/3/library/stdtypes.html#str) | [None](https://docs.python.org/3/library/constants.html#None)*

Branch Qualifier of the two-phase transaction.

#### prepared *: dt.datetime | [None](https://docs.python.org/3/library/constants.html#None)* *= None*

Timestamp at which the transaction was prepared for commit.

Only available on transactions recovered by [`tpc_recover()`](connections.md#psycopg.Connection.tpc_recover).

#### owner *: [str](https://docs.python.org/3/library/stdtypes.html#str) | [None](https://docs.python.org/3/library/constants.html#None)* *= None*

Named of the user that executed the transaction.

Only available on recovered transactions.

#### database *: [str](https://docs.python.org/3/library/stdtypes.html#str) | [None](https://docs.python.org/3/library/constants.html#None)* *= None*

Named of the database in which the transaction was executed.

Only available on recovered transactions.
